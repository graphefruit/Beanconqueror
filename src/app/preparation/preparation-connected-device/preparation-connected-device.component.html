<ion-header>
  <ion-toolbar>
    <ion-title>{{"PREPARATION_DEVICE_CONNECTION" | translate}}</ion-title>
    <ion-buttons slot="start">
      <ion-button (click)="dismiss()" class="big-icon-only">
        <ion-icon name="beanconqueror-back" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>
<ion-content>
  <ion-card>
    <ion-card-content>
      <ion-item>
        <ion-select label-placement="stacked" label='{{"PREPARATION_DEVICE.CHOOSE_DEVICE" | translate}}' (ngModelChange)="save()"  [(ngModel)]="preparation.connectedPreparationDevice.type"
                    cancelText="{{'CANCEL'| translate }}" cancelText="{{'CANCEL'| translate }}"
                    okText="{{'CHOOSE'| translate }}" okText="{{'CHOOSE'| translate }}" (ionChange)='setUrl()'>
          <ion-select-option value="{{PREPARATION_DEVICE_TYPE.NONE}}">{{"PREPARATION_DEVICE.TYPE.NONE" | translate}}</ion-select-option>
          <ion-select-option value="{{PREPARATION_DEVICE_TYPE.XENIA}}">{{"PREPARATION_DEVICE.TYPE.XENIA" | translate}}</ion-select-option>
          <ion-select-option value="{{PREPARATION_DEVICE_TYPE.METICULOUS}}">{{"PREPARATION_DEVICE.TYPE.METICULOUS" | translate}}</ion-select-option>
        </ion-select>
      </ion-item>
      <ion-item  *ngIf="preparation.connectedPreparationDevice.type ===  PREPARATION_DEVICE_TYPE.XENIA">
        <ion-label id='preparationURL'>{{"PREPARATION_DEVICE.URL" | translate}}</ion-label>
        <ion-input aria-labelledby='preparationURL' (ionBlur)="save()" [(ngModel)]="preparation.connectedPreparationDevice.url" placeholder="{{'PREPARATION_DEVICE.URL' | translate}}"
                   tabIndex="1" type="text"></ion-input>
        <ion-button (click)="checkURL()" class="big-icon-only" fill="clear"
                    slot="end" style="margin-left:0px;" tabIndex="2" tappable>
          <ion-icon class="ion-color-accent" name="checkmark-circle-outline" slot="icon-only"></ion-icon>
        </ion-button>
      </ion-item>
      <ion-item   *ngIf="preparation.connectedPreparationDevice.type ===  PREPARATION_DEVICE_TYPE.XENIA">
        <ion-select label-placement="stacked" label='{{"PREPARATION_DEVICE.API_VERSION" | translate}}'  (ngModelChange)="save()"  [(ngModel)]="preparation.connectedPreparationDevice.customParams.apiVersion" cancelText="{{'CANCEL'| translate }}"
                    name="apiVersion" okText="{{'CHOOSE'| translate }}">
          <ion-select-option value="V1">V1</ion-select-option>
          <ion-select-option value="V2">V2</ion-select-option>
        </ion-select>
      </ion-item>
      <ion-item lines='none'  *ngIf="preparation.connectedPreparationDevice.type ===  PREPARATION_DEVICE_TYPE.XENIA">
        <ion-label position="stacked" style="min-height:30px;">
          <h2>{{"PREPARATION_DEVICE.RESIDUAL_LAG_TIME" | translate }}&nbsp;<ion-badge
            style="vertical-align: top;">{{uiHelper.toFixedIfNecessary(preparation.connectedPreparationDevice.customParams.residualLagTime,2)}}</ion-badge></h2>
        </ion-label>
      </ion-item>
      <ion-item lines='none'  *ngIf="preparation.connectedPreparationDevice.type ===  PREPARATION_DEVICE_TYPE.XENIA">
        <ion-label>
          <p>{{"PREPARATION_DEVICE.RESIDUAL_LAG_TIME_DESCRIPTION" | translate }}</p>
        </ion-label>
      </ion-item>
      <ion-item  *ngIf="preparation.connectedPreparationDevice.type ===  PREPARATION_DEVICE_TYPE.XENIA" lines='inset'>
        <ion-range    [pinFormatter]="pinFormatter" [pin]="true" style='padding-left:15px;padding-right:15px;ppadding-bottom:0px;' (ionChange)="save()" [(ngModel)]="preparation.connectedPreparationDevice.customParams.residualLagTime" [max]="2" min="0" snaps="true"
                    [step]="0.05" >
        </ion-range>
      </ion-item>

      <ion-item  *ngIf="preparation.connectedPreparationDevice.type ===  PREPARATION_DEVICE_TYPE.METICULOUS">
        <ion-label id='preparationURL'>{{"PREPARATION_DEVICE.URL" | translate}}</ion-label>
        <ion-input aria-labelledby='preparationURL' (ionBlur)="save()" [(ngModel)]="preparation.connectedPreparationDevice.url" placeholder="{{'PREPARATION_DEVICE.URL' | translate}}"
                   tabIndex="1" type="text"></ion-input>

      </ion-item>
    </ion-card-content>
  </ion-card>



  <!--<ion-button (click)="getScripts()">get scripts</ion-button>
  <ion-button (click)="startScript()">start script</ion-button>
  <ion-input [(ngModel)]="scriptid" placeholder="scriptid" type="number"></ion-input>
  <ion-button (click)="stopScript()">stop script</ion-button>-->

</ion-content>
